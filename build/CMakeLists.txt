PROJECT(XCOMLZO)
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
IF(COMMAND cmake_policy)
  CMAKE_POLICY(SET CMP0003 NEW)
ENDIF(COMMAND cmake_policy)

SET(CMAKE_BUILD_TYPE Release)
SET(CMAKE_CXX_FLAGS_RELEASE "-std=c++11 -Wall -fexceptions -O2")

ADD_LIBRARY(ModParser ../ModParser.cpp ../ModParser.h)
ADD_LIBRARY(ModScript ../ModScript.cpp ../ModScript.h)
ADD_LIBRARY(UObject ../UObject.cpp ../UObject.h)
ADD_LIBRARY(UObjectFactory ../UObjectFactory.cpp ../UObjectFactory.h)
ADD_LIBRARY(UPKInfo ../UPKInfo.cpp ../UPKInfo.h)
ADD_LIBRARY(UPKUtils ../UPKUtils.cpp ../UPKUtils.h)
ADD_LIBRARY(minilzo ../minilzo.c ../minilzo.h ../lzodefs.h ../lzoconf.h)
ADD_LIBRARY(UToken ../UToken.cpp ../UToken.h)
ADD_LIBRARY(UTokenFactory ../UTokenFactory.cpp ../UTokenFactory.h)

ADD_EXECUTABLE(CompareUPK ../CompareUPK.cpp)
ADD_EXECUTABLE(ExtractNameLists ../ExtractNameLists.cpp)
ADD_EXECUTABLE(FindObjectByOffset ../FindObjectByOffset.cpp)
ADD_EXECUTABLE(FindObjectEntry ../FindObjectEntry.cpp)
ADD_EXECUTABLE(MoveExpandFunction ../MoveExpandFunction.cpp)
ADD_EXECUTABLE(PatchUPK ../PatchUPK.cpp)
ADD_EXECUTABLE(DecompressLZO ../DecompressLZO.cpp)
ADD_EXECUTABLE(HexToPseudoCode ../HexToPseudoCode.cpp)

TARGET_LINK_LIBRARIES(CompareUPK UPKInfo)
TARGET_LINK_LIBRARIES(ExtractNameLists UPKInfo)
TARGET_LINK_LIBRARIES(FindObjectByOffset UPKInfo)
TARGET_LINK_LIBRARIES(FindObjectEntry UPKInfo UPKUtils UObject UObjectFactory)
TARGET_LINK_LIBRARIES(MoveExpandFunction UPKInfo UPKUtils UObject UObjectFactory)
TARGET_LINK_LIBRARIES(PatchUPK ModScript ModParser UPKInfo UPKUtils UObject UObjectFactory)
TARGET_LINK_LIBRARIES(DecompressLZO minilzo UPKInfo)
TARGET_LINK_LIBRARIES(HexToPseudoCode UPKInfo UPKUtils UObject UObjectFactory UToken UTokenFactory)

IF(wxWidgets_USE_MONOLITHIC)
SET(wxWidgets_USE_LIBS mono)
ELSE(wxWidgets_USE_MONOLITHIC)
SET(wxWidgets_USE_LIBS base)
ENDIF(wxWidgets_USE_MONOLITHIC)

FIND_PACKAGE(wxWidgets)
IF(wxWidgets_FOUND)
  INCLUDE(${wxWidgets_USE_FILE})
  ADD_EXECUTABLE(DeserializeAll ../DeserializeAll)
  TARGET_LINK_LIBRARIES(DeserializeAll UPKInfo UPKUtils UObject UObjectFactory ${wxWidgets_LIBRARIES})
ELSE(wxWidgets_FOUND)
  MESSAGE("wxWidgets not found!")
ENDIF(wxWidgets_FOUND)
